' Gambas class file


Public Sub Form_Open()
Me.Left = Settings["Term/Left", Me.Left]
Me.Top = Settings["Term/Top", Me.Top]
TermF.Width = Settings["Term/Width", TermF.Width]
TermF.Height = Settings["Term/Height", TermF.Height]
End

Public Sub Form_Close()
Settings["Term/Left"] = Me.Left
Settings["Term/Top"] = Me.Top
Settings["Term/Width"] = TermF.Width
Settings["Term/Height"] = TermF.Height
If FMain.p Then FMain.p.Kill()
End


Public Sub ToolButton1_Click()

  Me.TView.Kill()
  Me.Close()

End

Public Sub Btn_SaveText_Click()

 Dialog.Title = "Save text to file.."
 If Dialog.SaveFile() Then Return
 File.Save(Dialog.Path, TView.Text)

Catch
 Message(Error.Text & "\n" & Error.Where)
End

Public Sub Btn_ClipCopy_Click()
Dim s As String = TView.Text
 Clipboard.Copy(s, "text/plain")
  Balloon.Info("Text Copied to local buffer.\nPaste it before closing this app.", Last)
End

Public Sub Btn_Clear_Click()

  TView.Clear()

End
Public Sub Form_KeyPress()
  Dim bRecieved As Boolean = True

  If Key.Control Then

    If key.code = Key["v"] Then 
      TView.Paste()

    Else If key.code = Key["c"] Then 
      TView.Copy()

    Else If key.code = Key["x"] Then 
      TView.Copy()

    Else If key.code = Key["a"] Then 
      'TView.SelectAll()
      Else
        bRecieved = False
    Endif
  If bRecieved Then Stop Event
  Endif
End

