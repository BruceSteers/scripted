' Gambas class file

Public aBackup As String[] = []

Public Sub Form_Open()
 If Me.Grid1.Rows.Count = 0 Then
  Grid1.Columns.Count = 3
  Grid1.Columns[0].Text = "Int"
  Grid1.Columns[0].Width = Grid1.Font.TextWidth("000") + 4
  Grid1.Columns[1].Text = "Val"
  Grid1.Columns[2].Text = "Name"
 Endif

Grid1.Columns.Sort = 2
Grid1.Rows.Count = 0 

AC(Highlight.Background, "Background")
AC(Highlight.Normal, "Normal")
AC(Highlight.Keyword, "Keyword")
AC(Highlight.Function, "Function")
AC(Highlight.Operator, "Operator")
AC(Highlight.Symbol, "Symbol")
AC(Highlight.Number, "Number")
AC(Highlight.String, "String")
AC(Highlight.Comment, "Comment")
AC(Highlight.Breakpoint, "Breakpoint")
AC(Highlight.Current, "Current")
AC(Highlight.Datatype, "Datatype")
AC(Highlight.Selection, "Selection")
AC(Highlight.Highlight, "Highlight")
AC(Highlight.CurrentLine, "CurrentLine")
AC(Highlight.Error, "Error")
AC(Highlight.Help, "Help")
AC(Highlight.Preprocessor, "Preprocessor")
AC(Highlight.Escape, "Escape")
AC(Highlight.Label, "Label")
AC(Highlight.Constant, "Constant")
'AC(Highlight.Alternate, "Alternate")
'AC(Highlight.Added, "Added")
'AC(Highlight.Removed, "Removed")
AC(Highlight.Custom, "Custom")
Grid1.Columns.Sort = -1
GetHighs()
End

Public Sub AC(i As Integer, s As String)
  
  Grid1.Rows.Count += 1
  Grid1[Grid1.Rows.Max, 0].Text = Str(i)
  Grid1[Grid1.Rows.Max, 1].Text = Str(FMain.TextEditor1.Styles[i].Color)
  Grid1[Grid1.Rows.Max, 2].Text = s
  If i = 0 Then
   Grid1[Grid1.Rows.Max, 0].Background = FMain.TextEditor1.Styles[i].Color
  Else
   Grid1[Grid1.Rows.Max, 0].Foreground = FMain.TextEditor1.Styles[i].Color
   Grid1[Grid1.Rows.Max, 0].Background = FMain.TextEditor1.Styles[0].Color
  Endif
End


Public Sub Grid1_Select()

  Me.ColorChooser1.Value = Val(Grid1[Grid1.Row, 1].Text)

End

Public Sub ColorChooser1_Change()
Dim c As Integer
Grid1[Grid1.Row, 1].Text = Str(Last.Value)
FMain.TextEditor1.Styles[Val(Grid1[Grid1.Row, 0].text)].Color = Last.Value
If Grid1.row <> 0 Then 
Grid1[Grid1.Row, 0].Foreground = Last.Value
Else
For c = 0 To Grid1.Rows.Max
  Grid1[c, 0].Background = Last.Value
Next
Endif
End

Public Sub Btn_Save_Click()
  Dim c As Integer
  For c = 0 To Grid1.Rows.Max
    Settings["Highlights/" & Grid1[c, 2].Text] = Val(Grid1[c, 1].Text)
  Next

    HighLights.Close()
End

Public Sub Grid1_Sort()
If Grid1.Columns.Sort = -1 Then Return

  Dim Values, ValueSorted As New String[]
  Dim Nx, iNx As Integer
  For Nx = 0 To Grid1.Rows.Max
    Values.Add(Grid1[Nx, Grid1.Columns.Sort].Text)
  Next
  ValueSorted = Values.Copy()
  ValueSorted.Sort()
  For Nx = 0 To ValueSorted.Max
    For iNx = 0 To Grid1.Columns.Max
      Swap Grid1[Nx, iNx].Text, Grid1[Values.Find(ValueSorted[Nx], 0, Nx), iNx].Text
    Next
    Values.Clear()
    For iNx = 0 To Grid1.Rows.Max
      Values.Add(Grid1[iNx, Grid1.Columns.Sort].Text)
    Next
  Next
  Grid1.Refresh()
End

Public Sub Btn_Revert_Click()
Dim c As Integer
For c = 0 To Grid1.Rows.Max
  Grid1[c, 1].Text = aBackup[c]
  FMain.TextEditor1.Styles[Val(Grid1[c, 0].Text)].Color = aBackup[c]
Next
End

Public Sub GetHighs()
Dim c As Integer
aBackup = []
For c = 0 To Grid1.Rows.Max
aBackup.Add(Grid1[c, 1].Text)
Next
End
